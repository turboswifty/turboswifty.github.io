# kappa的可解释性



## Kappa公式

$$
Kappa=\frac{p_0-p_e}{1-p_e}
$$

| 预测/实际      | Positive | Negtive | 总计(预测)  |
| -------------- | -------- | ------- | ----------- |
| **Positive**   | TP       | FP      | TP + FP     |
| **Negtive**    | FN       | TN      | FN + TN     |
| **总计(实际)** | TP + FN  | FP + TN | N(全加起来) |



其中:

- $p_0$: 实际观察到的一致性比例 *(observed aggrement)*  
  $$
  p_0=\frac{TP+TN}{N(总数)}
  $$

- $p_e$: 随机猜测下预期的一致性比例 *(expected aggrement)*
  $$
  p_e = (\frac{TP+FP}{N} \times \frac{TP+FN}{N}) + (\frac{FN+TN}{N} \times \frac{FP + TN}{N})
  $$
  

$$
实际就是：预测为正的概率\times实际为正的概率 + 预测为负的概率\times实际为负的概率
$$

## 疑问解惑



实际上我想不明白的点就是这个公式为什么会写成这样，为什么写成这样就能消除类别本身数量不平衡造成的影响

- **为什么写成这样：**

  分子是用观察到的预测准确率减去随机猜测的准确率，实际上就相当于只要得到去除随机预测给你提供的增益之后还剩多少准确率，如果还是正数，那就是比纯随机预测准一点；要是为负了，那就是说预测能力还不如随机预测呢

  分母是相当于做归一化，方便在不同样本数以及情况下做比较，因为$p_0$最大为1嘛。

- **为什么$p_e$就是随机猜测下预期的一致性比例：**

  因为如果假设预测机器是随机瞎预测的，也就是预测和现实中正负比例没关系。那么也就是说预测为正和实际为正这两件事是独立不相关的，所以求两件事情同时发生的概率可以直接相乘。

  从而可以得到：
  $$
  P(实际为正，预测为正)=P(实际为正)\times P(预测为正)
  $$

  $$
  P(实际为负，预测为负)=P(实际为负)\times P(预测为负)
  $$

  从而可得：
  $$
  P(随机猜测下预测准确的概率)=P(实际为正，预测为正)+P(实际为负，预测为负) 
  $$
  也就是上面的***公式(3)***

## 上面就是Kappa的原理以及细节解析

